Controller={cursorSize:5,helpWindow:!1,showHelpWindowOnStart:!0,canShowNextWindow:!0,helpViews:[],currentHelpView:null,numberOfClockwise:0,numberOfCounterClockwise:0,initialize:function(){Controller.helpViews=["h1.html","h2.html","h3.html","h4.html"],$(document).keyup(function(t){Controller.handleKeypress(t)}),$(document).ready(function(){var t=$(window).height();$("#map-canvas").height(t),MapsController.initialize(),Controller.showHelpWindowOnStart&&Controller.addOrRemoveHelpWindow()}),$(window).resize(function(){var t=$(window).height();$("#map-canvas").height(t),Controller.computeCanvasSize()})},attachDetachCanvas:function(t){if(t){if(null==document.getElementById("cursor-canvas")){var e=document.createElement("canvas");e.height=$("#map-canvas").height(),e.width=$("#map-canvas").width(),e.setAttribute("id","cursor-canvas");var n=document.getElementById("wrapper");n.setAttribute("class","no-mouse");var r=document.getElementById("map-canvas");n.insertBefore(e,r)}}else if(document.getElementById("cursor-canvas")){document.getElementById("cursor-canvas").remove();var n=document.getElementById("wrapper");n.removeAttribute("class")}},computeCanvasSize:function(){if(document.getElementById("cursor-canvas")){var t=$("#map-canvas").height(),e=$("#map-canvas").width(),n=document.getElementsByTagName("canvas")[0];n.width=e,n.height=t}},drawCursor:function(t,e){if(!Controller.helpWindow){t>$("#map-canvas").width()-Controller.cursorSize&&(t=$("#map-canvas").width()-Controller.cursorSize),e>$("#map-canvas").height()-Controller.cursorSize&&(e=$("#map-canvas").height()-Controller.cursorSize);var n=document.getElementById("cursor-canvas");if(n){var r=n.getContext("2d");r.clearRect(0,0,r.canvas.width,r.canvas.height),r.beginPath(),r.rect(t,e,Controller.cursorSize,Controller.cursorSize),r.fill()}}},addOrRemoveHelpWindow:function(){if(Controller.helpWindow)Controller.helpWindow=!1,document.getElementById("help")&&document.getElementById("help").remove(),document.getElementById("modal-canvas")&&document.getElementById("modal-canvas").remove();else{Controller.helpWindow=!0;var t=document.createElement("div");if(t.setAttribute("id","help"),document.getElementById("wrapper").appendChild(t),Controller.loadHelpView(0),Controller.attachDetachCanvas(!1),null==document.getElementById("modal-canvas")){var e=document.createElement("canvas");e.height=$("#map-canvas").height(),e.width=$("#map-canvas").width(),e.setAttribute("id","modal-canvas");var n=document.getElementById("wrapper"),r=document.getElementById("map-canvas");n.insertBefore(e,r)}}},addOrRmoveLogWindow:function(){if(null==document.getElementById("log-window")){var t=document.createElement("div");t.setAttribute("id","log-window"),document.getElementById("wrapper").appendChild(t)}else document.getElementById("log-window").remove()},computePanningAcceleration:function(t,e){if(!Controller.helpWindow&&!MapsController.isInStreetView()){var n=.33*window.innerWidth,r=.66*window.innerWidth,o=.33*window.innerHeight,i=.66*window.innerHeight,a=0,s=0;t>r?a=Controller.mapValueToInterval(t,r,window.innerWidth,0,15):n>t&&(a=Controller.mapValueToInterval(t,0,n,-15,0)),e>i?s=Controller.mapValueToInterval(e,i,window.innerHeight,0,15):o>e&&(s=Controller.mapValueToInterval(e,0,o,-15,0)),MapsController.panBy(a,s)}},mapValueToInterval:function(t,e,n,r,o){return Math.round((o-r)/(n-e)*(t-e)+r)},handleKeypress:function(t){switch(t.keyCode){case 27:Controller.helpWindow?Controller.addOrRemoveHelpWindow():MapsController.isInStreetView()&&MapsController.switchMapMode(0,0);break;case 37:Controller.handleSwipe("fromLeftToRight");break;case 39:Controller.handleSwipe("fromRightToLeft");break;case 72:Controller.addOrRemoveHelpWindow();break;case 76:Controller.addOrRmoveLogWindow()}},handleCircle:function(t){Controller.helpWindow||(t?(Controller.numberOfClockwise++,35==Controller.numberOfClockwise&&(Controller.numberOfClockwise=0,MapsController.isInStreetView()?MapsController.moveStreetView(!0):MapsController.zoomMap(!0))):(Controller.numberOfCounterClockwise++,35==Controller.numberOfCounterClockwise&&(Controller.numberOfCounterClockwise=0,MapsController.isInStreetView()?MapsController.moveStreetView(!1):MapsController.zoomMap(!1))))},handleSwipe:function(t){if(Controller.helpWindow){if(Controller.canShowNextWindow){for(var e=null,n=0;n<Controller.helpViews.length;n++)if(Controller.currentHelpView==Controller.helpViews[n]){e="fromRightToLeft"==t?n+1:n-1;break}e>=0&&e<Controller.helpViews.length?Controller.loadHelpView(e):-1!=e&&Controller.addOrRemoveHelpWindow()}Controller.canShowNextWindow=!1,Controller.sleep(250,Controller.releaseLock)}else MapsController.isInStreetView()&&MapsController.rotate360(t)},handleKeyTap:function(t){Controller.helpWindow||MapsController.isInStreetView()||MapsController.addRemoveMarker(t.x,t.y)},handleScreenTap:function(t){Controller.helpWindow||MapsController.switchMapMode(t.x,t.y)},loadHelpView:function(t){$(function(){$("#help").load("views/help/"+Controller.helpViews[t]),Controller.currentHelpView=Controller.helpViews[t]})},releaseLock:function(){Controller.canShowNextWindow=!0},sleep:function(t,e){setTimeout(function(){e()},t)}},LeapMotionController={controller:Leap.loop({enableGestures:!0},function(t){if(!Controller.helpWindow){LeapMotionController.attachDetachCanvas(t);var e=LeapMotionController.computeHandPosition(t);e&&(Controller.drawCursor(e.x,e.y),5==LeapMotionController.getNumberOfFingers(t.hands[0])&&Controller.computePanningAcceleration(e.x,e.y))}LeapMotionController.detectAndHandleGestures(t),LeapMotionController.logData(t)}),logData:function(t){if(document.getElementById("log-window")){var e="";e="<b>Real time data: <br><hr>",e+="Google Maps: <br></b>";var n=MapsController.map,r=n.getCenter();if(e+=LeapMotionController.concatData("lat",r.lat()),e+=LeapMotionController.concatData("lng",r.lng()),MapsController.isInStreetView()){var o=n.getStreetView(),i=o.getPov();if(e+=LeapMotionController.concatData("Heading",i.heading),e+=LeapMotionController.concatData("Pitch",i.pitch),o.getLinks())for(var a=0;a<o.getLinks().length;a++)e+=LeapMotionController.concatData("Available heading "+a,o.getLinks()[a].heading)}else e+=LeapMotionController.concatData("Zoom",n.getZoom());e+="<hr><b>Leap Motion: <br></b>",e+=LeapMotionController.concatData("frame_id",t.id),e+=LeapMotionController.concatData("Number of hands",t.hands.length),e+=LeapMotionController.concatData("Number of fingers",LeapMotionController.getNumberOfFingers(t.hands[0])+LeapMotionController.getNumberOfFingers(t.hands[1]));for(var a=0;a<t.hands.length;a++){var s=t.hands[a];e+="<br>",e+=LeapMotionController.concatData("Hand type",s.type),e+=LeapMotionController.concatData("Hand confidence",s.confidence),e+=LeapMotionController.concatData("Hand position x",s.palmPosition[0]+" mm"),e+=LeapMotionController.concatData("Hand position y",s.palmPosition[1]+" mm"),e+=LeapMotionController.concatData("Hand position z",s.palmPosition[2]+" mm")}if(e+="<br>",e+="Gestures:<br>",t.gestures.length>0)for(var u=0;u<t.gestures.length;u++){var c=t.gestures[u];e+=LeapMotionController.concatData("Gesture name",c.type),e+=LeapMotionController.concatData("Gesture state",c.state),e+=LeapMotionController.concatData("Gesture duration",c.duration+" microseconds"),e+="<br>"}var l=document.getElementById("log-window");l.innerHTML=e}},concatData:function(t,e){return t+": "+e+"<br>"},attachDetachCanvas:function(t){Controller.attachDetachCanvas(LeapMotionController.isOneHand(t))},computeHandPosition:function(t){if(t.valid&&1==t.hands.length&&t.pointables.length>0){var e=t.pointables[0].stabilizedTipPosition,n=t.interactionBox.normalizePoint(e,!0),r=$("#map-canvas").width()*n[0],o=$("#map-canvas").height()*(1-n[1]),i={x:r,y:o};return i}return null},detectAndHandleGestures:function(t){t.valid&&t.gestures.length>0&&t.gestures.forEach(function(e){switch(e.type){case"circle":LeapMotionController.handleCircle(t,e);break;case"keyTap":break;case"screenTap":LeapMotionController.handleScreenTap(t);break;case"swipe":LeapMotionController.handleSwipe(e)}})},handleCircle:function(t,e){if(1==LeapMotionController.getNumberOfFingers(t.hands[0])){var n=!1,r=e.pointableIds[0],o=t.pointable(r).direction;if(o){var i=Leap.vec3.dot(o,e.normal);i>0&&(n=!0),Controller.handleCircle(n)}}},handleKeyTap:function(t){if(LeapMotionController.isOneHand(t)&&1==LeapMotionController.getNumberOfFingers(t.hands[0])){var e=LeapMotionController.computeHandPosition(t);e&&Controller.handleKeyTap(e)}},handleScreenTap:function(t){if(1==LeapMotionController.getNumberOfFingers(t.hands[0])){var e=LeapMotionController.computeHandPosition(t);e&&Controller.handleScreenTap(e)}},handleSwipe:function(t){if("stop"==t.state){var e=Math.abs(t.direction[0])>Math.abs(t.direction[1]);swipeDirection=e?t.direction[0]>0?"fromLeftToRight":"fromRightToLeft":t.direction[1]>0?"fromBottomToTop":"fromTopToBottom",Controller.handleSwipe(swipeDirection)}},isOneHand:function(t){return t.valid&&1==t.hands.length},getNumberOfFingers:function(t){var e=0;if(t)for(var n=0;n<t.fingers.length;n++){var r=t.fingers[n];r.extended&&e++}return e},getFingerName:function(t){switch(t){case 0:return"Thumb";case 1:return"Index";case 2:return"Middle";case 3:return"Ring";case 4:return"Pinky"}}},MapsController={map:null,lat:46.76907446541323,lng:23.59061690807345,pitchHeadingStep:7.5,streetViewRenderingRadius:150,streetViewAngleThreshold:40,zoom:10,zoomStep:1,panoramaZoomStep:.2,markers:[],initialize:function(){var t={center:new google.maps.LatLng(MapsController.lat,MapsController.lng),zoom:MapsController.zoom,maxZoom:18,minZoom:3,panControl:!1,zoomControl:!1,draggable:!0};MapsController.map=new google.maps.Map(document.getElementById("map-canvas"),t)},isInStreetView:function(){return MapsController.map.getStreetView().getVisible()},panBy:function(t,e){MapsController.isInStreetView()||(0!=t||0!=e)&&MapsController.map.panBy(t,e)},moveMap:function(t,e){MapsController.isInStreetView()||MapsController.map.panTo(new google.maps.LatLng(t,e))},rotate360:function(t){if(MapsController.isInStreetView()){var e=MapsController.map.getStreetView().getPov().pitch,n=MapsController.map.getStreetView().getPov().heading;switch(t){case"fromBottomToTop":e<90-MapsController.pitchHeadingStep&&(e+=MapsController.pitchHeadingStep);break;case"fromTopToBottom":e>-90+MapsController.pitchHeadingStep&&(e-=MapsController.pitchHeadingStep);break;case"fromLeftToRight":n+=MapsController.pitchHeadingStep;break;case"fromRightToLeft":n-=MapsController.pitchHeadingStep}n%=360,MapsController.map.getStreetView().setPov({heading:n,pitch:e})}},zoomMap:function(t){if(MapsController.isInStreetView()){var e=MapsController.map.getStreetView().getZoom();direction?e+=MapsController.panoramaZoomStep:e-=MapsController.panoramaZoomStep,MapsController.map.getStreetView().setZoom(e)}else{var n=MapsController.map.getZoom();t?n+=MapsController.zoomStep:n-=MapsController.zoomStep,MapsController.map.setZoom(n)}},moveStreetView:function(t){if(MapsController.isInStreetView()){var e=MapsController.map.getStreetView().getPov().heading;e%=360,0>e&&(e+=360),t||(e-=180,0>e&&(e+=360));for(var n=0;n<MapsController.map.getStreetView().getLinks().length;n++){var r=MapsController.map.getStreetView().getLinks()[n].heading;e>r-MapsController.streetViewAngleThreshold&&e<r+MapsController.streetViewAngleThreshold&&(MapsController.map.getStreetView().setPano(MapsController.map.getStreetView().getLinks()[n].pano),t||(r-=180,0>r&&(r+=360)),MapsController.map.getStreetView().setPov({heading:r,pitch:MapsController.map.getStreetView().getPov().pitch}))}}},addRemoveMarker:function(t,e){var n=new google.maps.Marker({position:MapsController.fromPixelToLatLng(t,e),map:MapsController.map});MapsController.markers.push(n)},switchMapMode:function(t,e){if(MapsController.isInStreetView())MapsController.map.getStreetView().setVisible(!1);else{var n=MapsController.fromPixelToLatLng(t,e),r=new google.maps.StreetViewService;r.getPanoramaByLocation(n,MapsController.streetViewRenderingRadius,function(t,e){if("OK"==e){var r={pano:t.location.pano};MapsController.map.setStreetView(new google.maps.StreetViewPanorama(document.getElementById("map-canvas"),r)),MapsController.map.getStreetView().setZoom(0)}else alert("There is no street view panorama available for a radius of "+MapsController.streetViewRenderingRadius+" meters at this coordinates: lat: "+n.lat()+", lng: "+n.lng()+"\n\nPlease try again")})}},fromPointToLatLng:function(t,e){var n=Math.pow(2,e),r=new google.maps.Point(t.x/n,t.y/n);return latLng=MapsController.map.getProjection().fromPointToLatLng(r)},fromPixelToLatLng:function(t,e){var n=MapsController.map.getBounds(),r=n.getNorthEast(),o=n.getSouthWest(),i=MapsController.map.getProjection().fromLatLngToPoint(r),a=MapsController.map.getProjection().fromLatLngToPoint(o),s=t/$("#map-canvas").width(),u=e/$("#map-canvas").height(),c=(i.x-a.x)*s+a.x,l=(a.y-i.y)*u+i.y;return newLatLng=MapsController.map.getProjection().fromPointToLatLng(new google.maps.Point(c,l))}},function(t,e,n){function r(n,i){if(!e[n]){if(!t[n]){var a="function"==typeof require&&require;if(!i&&a)return a(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=e[n]={exports:{}};t[n][0].call(s.exports,function(e){var o=t[n][1][e];return r(o?o:e)},s,s.exports)}return e[n].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e){var n=(t("./pointable"),t("gl-matrix")),r=n.vec3,o=n.mat3,i=n.mat4,a=(t("underscore"),e.exports=function(t,e){this.finger=t,this._center=null,this._matrix=null,this.type=e.type,this.prevJoint=e.prevJoint,this.nextJoint=e.nextJoint,this.width=e.width;var n=new Array(3);r.sub(n,e.nextJoint,e.prevJoint),this.length=r.length(n),this.basis=e.basis});a.prototype.left=function(){return this._left?this._left:(this._left=o.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))<0,this._left)},a.prototype.matrix=function(){if(this._matrix)return this._matrix;var t=this.basis,e=this._matrix=i.create();return e[0]=t[0][0],e[1]=t[0][1],e[2]=t[0][2],e[4]=t[1][0],e[5]=t[1][1],e[6]=t[1][2],e[8]=t[2][0],e[9]=t[2][1],e[10]=t[2][2],e[3]=this.center()[0],e[7]=this.center()[1],e[11]=this.center()[2],this.left()&&(e[0]*=-1,e[1]*=-1,e[2]*=-1),this._matrix},a.prototype.lerp=function(t,e){r.lerp(t,this.prevJoint,this.nextJoint,e)},a.prototype.center=function(){if(this._center)return this._center;var t=r.create();return this.lerp(t,.5),this._center=t,t},a.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},{"./pointable":14,"gl-matrix":23,underscore:24}],2:[function(t,e){var n=e.exports=function(t){this.pos=0,this._buf=[],this.size=t};n.prototype.get=function(t){return void 0==t&&(t=0),t>=this.size?void 0:t>=this._buf.length?void 0:this._buf[(this.pos-t-1)%this.size]},n.prototype.push=function(t){return this._buf[this.pos%this.size]=t,this.pos++}},{}],3:[function(t,e){var n=t("../protocol").chooseProtocol,r=t("events").EventEmitter,o=t("underscore"),i=e.exports=function(t){this.opts=o.defaults(t||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,requestProtocolVersion:i.defaultProtocolVersion}),this.host=this.opts.host,this.port=this.opts.port,this.scheme=this.opts.scheme,this.protocolVersionVerified=!1,this.on("ready",function(){this.enableGestures(this.opts.enableGestures),this.setBackground(this.opts.background)})};i.defaultProtocolVersion=6,i.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"},i.prototype.getScheme=function(){return"ws:"},i.prototype.getPort=function(){return 6437},i.prototype.setBackground=function(t){this.opts.background=t,this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))},i.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))},i.prototype.enableGestures=function(t){this.gesturesEnabled=t?!0:!1,this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))},i.prototype.handleClose=function(t){this.connected&&(this.disconnect(),1001===t&&this.opts.requestProtocolVersion>1&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())},i.prototype.startReconnection=function(){var t=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){t.reconnect()},500))},i.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)},i.prototype.disconnect=function(t){return t||this.stopReconnection(),this.socket?(this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0):void 0},i.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())},i.prototype.handleData=function(t){var e,r=JSON.parse(t);void 0===this.protocol?(e=this.protocol=n(r),this.protocolVersionVerified=!0,this.emit("ready")):e=this.protocol(r),this.emit(e.type,e)},i.prototype.connect=function(){return this.socket?void 0:(this.socket=this.setupSocket(),!0)},i.prototype.send=function(t){this.socket.send(t)},i.prototype.reportFocus=function(t){this.connected&&this.focusedState!==t&&(this.focusedState=t,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))},o.extend(i.prototype,r.prototype)},{"../protocol":15,events:21,underscore:24}],4:[function(t,e){var n=e.exports=t("./base"),r=t("underscore"),o=e.exports=function(t){n.call(this,t);var e=this;this.on("ready",function(){e.startFocusLoop()}),this.on("disconnect",function(){e.stopFocusLoop()})};r.extend(o.prototype,n.prototype),o.__proto__=n,o.prototype.useSecure=function(){return"https:"===location.protocol},o.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"},o.prototype.getPort=function(){return this.useSecure()?6436:6437},o.prototype.setupSocket=function(){var t=this,e=new WebSocket(this.getUrl());return e.onopen=function(){t.handleOpen()},e.onclose=function(e){t.handleClose(e.code,e.reason)},e.onmessage=function(e){t.handleData(e.data)},e.onerror=function(){t.useSecure()&&"wss:"===t.scheme&&(t.scheme="ws:",t.port=6437,t.disconnect(),t.connect())},e},o.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var t=this,e=null;e="undefined"!=typeof document.hidden?"hidden":"undefined"!=typeof document.mozHidden?"mozHidden":"undefined"!=typeof document.msHidden?"msHidden":"undefined"!=typeof document.webkitHidden?"webkitHidden":void 0,void 0===t.windowVisible&&(t.windowVisible=void 0===e?!0:document[e]===!1);var n=window.addEventListener("focus",function(){t.windowVisible=!0,o()}),r=window.addEventListener("blur",function(){t.windowVisible=!1,o()});this.on("disconnect",function(){window.removeEventListener("focus",n),window.removeEventListener("blur",r)});var o=function(){var n=void 0===e?!0:document[e]===!1;t.reportFocus(n&&t.windowVisible)};o(),this.focusDetectorTimer=setInterval(o,100)}},o.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":3,underscore:24}],5:[function(t,e){var n=t("__browserify_process"),r=t("./frame"),o=t("./hand"),i=t("./pointable"),a=t("./finger"),s=t("./circular_buffer"),u=t("./pipeline"),c=t("events").EventEmitter,l=t("./gesture").gestureListener,p=t("./dialog"),h=t("underscore"),d=e.exports=function(e){var o="undefined"!=typeof n&&n.versions&&n.versions.node,i=this;e=h.defaults(e||{},{inNode:o}),this.inNode=e.inNode,e=h.defaults(e||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!1,useAllPlugins:!1,checkVersion:!0}),this.animationFrameRequested=!1,this.onAnimationFrame=function(){i.emit("animationFrame",i.lastConnectionFrame),i.loopWhileDisconnected&&(i.connection.focusedState||i.connection.opts.background)?window.requestAnimationFrame(i.onAnimationFrame):i.animationFrameRequested=!1},this.suppressAnimationLoop=e.suppressAnimationLoop,this.loopWhileDisconnected=e.loopWhileDisconnected,this.frameEventName=e.frameEventName,this.useAllPlugins=e.useAllPlugins,this.history=new s(200),this.lastFrame=r.Invalid,this.lastValidFrame=r.Invalid,this.lastConnectionFrame=r.Invalid,this.accumulatedGestures=[],this.checkVersion=e.checkVersion,this.connectionType=void 0===e.connectionType?t(this.inBrowser()?"./connection/browser":"./connection/node"):e.connectionType,this.connection=new this.connectionType(e),this.streamingCount=0,this.devices={},this.plugins={},this._pluginPipelineSteps={},this._pluginExtendedMethods={},e.useAllPlugins&&this.useRegisteredPlugins(),this.setupFrameEvents(e),this.setupConnectionEvents()};d.prototype.gesture=function(t,e){var n=l(this,t);return void 0!==e&&n.stop(e),n},d.prototype.setBackground=function(t){return this.connection.setBackground(t),this},d.prototype.inBrowser=function(){return!this.inNode},d.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()},d.prototype.inBackgroundPage=function(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window},d.prototype.connect=function(){return this.connection.connect(),this},d.prototype.streaming=function(){return this.streamingCount>0},d.prototype.connected=function(){return!!this.connection.connected},d.prototype.runAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))},d.prototype.disconnect=function(){return this.connection.disconnect(),this},d.prototype.frame=function(t){return this.history.get(t)||r.Invalid},d.prototype.loop=function(t){return t&&("function"==typeof t?this.on(this.frameEventName,t):this.setupFrameEvents(t)),this.connect()},d.prototype.addStep=function(t){this.pipeline||(this.pipeline=new u(this)),this.pipeline.addStep(t)},d.prototype.processFrame=function(t){t.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(t.gestures)),this.lastConnectionFrame=t,this.runAnimationLoop(),this.emit("deviceFrame",t)},d.prototype.processFinishedFrame=function(t){if(this.lastFrame=t,t.valid&&(this.lastValidFrame=t),t.controller=this,t.historyIdx=this.history.push(t),t.gestures){t.gestures=this.accumulatedGestures,this.accumulatedGestures=[];for(var e=0;e!=t.gestures.length;e++)this.emit("gesture",t.gestures[e],t)}this.pipeline&&(t=this.pipeline.run(t),t||(t=r.Invalid)),this.emit("frame",t),this.emitHandEvents(t)},d.prototype.emitHandEvents=function(t){for(var e=0;e<t.hands.length;e++)this.emit("hand",t.hands[e])},d.prototype.setupFrameEvents=function(t){t.frame&&this.on("frame",t.frame),t.hand&&this.on("hand",t.hand)},d.prototype.setupConnectionEvents=function(){var t=this;this.connection.on("frame",function(e){t.processFrame(e)}),this.on(this.frameEventName,function(e){t.processFinishedFrame(e)});var e=function(){if(t.connection.opts.requestProtocolVersion<5&&0==t.streamingCount){t.streamingCount=1;var n={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};t.devices[n.id]=n,t.emit("deviceAttached",n),t.emit("deviceStreaming",n),t.emit("streamingStarted",n),t.connection.removeListener("frame",e)}},n=function(){if(t.streamingCount>0){for(var e in t.devices)t.emit("deviceStopped",t.devices[e]),t.emit("deviceRemoved",t.devices[e]);t.emit("streamingStopped",t.devices[e]),t.streamingCount=0;for(var e in t.devices)delete t.devices[e]}};this.connection.on("focus",function(){t.emit("focus")}),this.connection.on("blur",function(){t.emit("blur")}),this.connection.on("protocol",function(e){e.on("beforeFrameCreated",function(e){t.emit("beforeFrameCreated",e)}),e.on("afterFrameCreated",function(e,n){t.emit("afterFrameCreated",e,n)}),t.emit("protocol",e)}),this.connection.on("ready",function(){t.checkVersion&&!t.inNode&&t.checkOutOfDate(),t.emit("ready")}),this.connection.on("connect",function(){t.emit("connect"),t.connection.removeListener("frame",e),t.connection.on("frame",e)}),this.connection.on("disconnect",function(){t.emit("disconnect"),n()}),this.connection.on("deviceConnect",function(r){r.state?(t.emit("deviceConnected"),t.connection.removeListener("frame",e),t.connection.on("frame",e)):(t.emit("deviceDisconnected"),n())}),this.connection.on("deviceEvent",function(e){var n=e.state,r=t.devices[n.id],o={};for(var i in n)r&&r.hasOwnProperty(i)&&r[i]==n[i]||(o[i]=!0);t.devices[n.id]=n,o.attached&&t.emit(n.attached?"deviceAttached":"deviceRemoved",n),o.streaming&&(n.streaming?(t.streamingCount++,t.emit("deviceStreaming",n),1==t.streamingCount&&t.emit("streamingStarted",n),o.attached||t.emit("deviceConnected")):o.attached&&n.attached||(t.streamingCount--,t.emit("deviceStopped",n),0==t.streamingCount&&t.emit("streamingStopped",n),t.emit("deviceDisconnected")))}),this.on("newListener",function(t){})},d.prototype.checkOutOfDate=function(){var t=this.connection.protocol.serviceVersion,e=this.connection.protocol.version,n=this.connectionType.defaultProtocolVersion;return n>e?(p.warnOutOfDate({sV:t,pV:e}),!0):!1},d._pluginFactories={},d.plugin=function(t,e){return this._pluginFactories[t],this._pluginFactories[t]=e},d.plugins=function(){return h.keys(this._pluginFactories)};var f=function(t,e,n){-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(e)?this.on(e,n):(this.pipeline||(this.pipeline=new u(this)),this._pluginPipelineSteps[t]||(this._pluginPipelineSteps[t]=[]),this._pluginPipelineSteps[t].push(this.pipeline.addWrappedStep(e,n)))},m=function(t,e,n){var s;switch(this._pluginExtendedMethods[t]||(this._pluginExtendedMethods[t]=[]),e){case"frame":s=r;break;case"hand":s=o;break;case"pointable":s=i,h.extend(a.prototype,n),h.extend(a.Invalid,n);break;case"finger":s=a;break;default:throw t+' specifies invalid object type "'+e+'" for prototypical extension'}h.extend(s.prototype,n),h.extend(s.Invalid,n),this._pluginExtendedMethods[t].push([s,n])};d.prototype.use=function(t,e){var n,r,o,i;if(r="function"==typeof t?t:d._pluginFactories[t],!r)throw"Leap Plugin "+t+" not found.";if(e||(e={}),this.plugins[t])return h.extend(this.plugins[t],e),this;this.plugins[t]=e,i=r.call(this,e);for(o in i)n=i[o],"function"==typeof n?f.call(this,t,o,n):m.call(this,t,o,n);return this},d.prototype.stopUsing=function(t){var e,n,r=this._pluginPipelineSteps[t],o=this._pluginExtendedMethods[t],i=0;if(this.plugins[t]){if(r)for(i=0;i<r.length;i++)this.pipeline.removeStep(r[i]);if(o)for(i=0;i<o.length;i++){e=o[i][0],n=o[i][1];for(var a in n)delete e.prototype[a],delete e.Invalid[a]}return delete this.plugins[t],this}},d.prototype.useRegisteredPlugins=function(){for(var t in d._pluginFactories)this.use(t)},h.extend(d.prototype,c.prototype)},{"./circular_buffer":2,"./connection/browser":4,"./connection/node":20,"./dialog":6,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./pipeline":13,"./pointable":14,__browserify_process:22,events:21,underscore:24}],6:[function(t,e){var n=t("__browserify_process"),r=e.exports=function(t,e){this.options=e||{},this.message=t,this.createElement()};r.prototype.createElement=function(){this.element=document.createElement("div"),this.element.className="leapjs-dialog",this.element.style.position="fixed",this.element.style.top="8px",this.element.style.left=0,this.element.style.right=0,this.element.style.textAlign="center",this.element.style.zIndex=1e3;var t=document.createElement("div");this.element.appendChild(t),t.style.className="leapjs-dialog",t.style.display="inline-block",t.style.margin="auto",t.style.padding="8px",t.style.color="#222",t.style.background="#eee",t.style.borderRadius="4px",t.style.border="1px solid #999",t.style.textAlign="left",t.style.cursor="pointer",t.style.whiteSpace="nowrap",t.style.transition="box-shadow 1s linear",t.innerHTML=this.message,this.options.onclick&&t.addEventListener("click",this.options.onclick),this.options.onmouseover&&t.addEventListener("mouseover",this.options.onmouseover),this.options.onmouseout&&t.addEventListener("mouseout",this.options.onmouseout),this.options.onmousemove&&t.addEventListener("mousemove",this.options.onmousemove)},r.prototype.show=function(){return document.body.appendChild(this.element),this},r.prototype.hide=function(){return document.body.removeChild(this.element),this},r.warnOutOfDate=function(t){t||(t={});var e="http://developer.leapmotion.com?";t.returnTo=window.location.href;for(var n in t)e+=n+"="+encodeURIComponent(t[n])+"&";var o,i=function(t){if("leapjs-decline-upgrade"!=t.target.id){var n=window.open(e,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1");window.focus&&n.focus()}return o.hide(),!0},a="This site requires Leap Motion Tracking Beta, now available for developers.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>";return o=new r(a,{onclick:i,onmousemove:function(t){t.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}}),o.show()},r.hasWarnedBones=!1,r.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,"undefined"!=typeof n&&n.versions&&n.versions.node||this.warnOutOfDate({reason:"bones"}))}},{__browserify_process:22}],7:[function(t,e){var n=t("./pointable"),r=t("./bone"),o=t("./dialog"),i=t("underscore"),a=e.exports=function(t){n.call(this,t),this.dipPosition=t.dipPosition,this.pipPosition=t.pipPosition,this.mcpPosition=t.mcpPosition,this.carpPosition=t.carpPosition,this.extended=t.extended,this.type=t.type,this.finger=!0,this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition],t.bases?this.addBones(t):o.warnBones()};i.extend(a.prototype,n.prototype),a.prototype.addBones=function(t){this.metacarpal=new r(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:t.bases[0]}),this.proximal=new r(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:t.bases[1]}),this.medial=new r(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:t.bases[2]}),this.distal=new r(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:t.btipPosition,basis:t.bases[3]}),this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]},a.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},a.Invalid={valid:!1}},{"./bone":1,"./dialog":6,"./pointable":14,underscore:24}],8:[function(t,e){var n=t("./hand"),r=t("./pointable"),o=t("./gesture").createGesture,i=t("gl-matrix"),a=i.mat3,s=i.vec3,u=t("./interaction_box"),c=t("./finger"),l=t("underscore"),p=e.exports=function(t){if(this.valid=!0,this.id=t.id,this.timestamp=t.timestamp,this.hands=[],this.handsMap={},this.pointables=[],this.tools=[],this.fingers=[],t.interactionBox&&(this.interactionBox=new u(t.interactionBox)),this.gestures=[],this.pointablesMap={},this._translation=t.t,this._rotation=l.flatten(t.r),this._scaleFactor=t.s,this.data=t,this.type="frame",this.currentFrameRate=t.currentFrameRate,t.gestures)for(var e=0,n=t.gestures.length;e!=n;e++)this.gestures.push(o(t.gestures[e]));
this.postprocessData(t)};p.prototype.postprocessData=function(t){t||(t=this.data);for(var e=0,o=t.hands.length;e!=o;e++){var i=new n(t.hands[e]);i.frame=this,this.hands.push(i),this.handsMap[i.id]=i}t.pointables=l.sortBy(t.pointables,function(t){return t.id});for(var a=0,s=t.pointables.length;a!=s;a++){var u=t.pointables[a],p=u.dipPosition?new c(u):new r(u);p.frame=this,this.addPointable(p)}},p.prototype.addPointable=function(t){if(this.pointables.push(t),this.pointablesMap[t.id]=t,(t.tool?this.tools:this.fingers).push(t),void 0!==t.handId&&this.handsMap.hasOwnProperty(t.handId)){var e=this.handsMap[t.handId];switch(e.pointables.push(t),(t.tool?e.tools:e.fingers).push(t),t.type){case 0:e.thumb=t;break;case 1:e.indexFinger=t;break;case 2:e.middleFinger=t;break;case 3:e.ringFinger=t;break;case 4:e.pinky=t}}},p.prototype.tool=function(t){var e=this.pointable(t);return e.tool?e:r.Invalid},p.prototype.pointable=function(t){return this.pointablesMap[t]||r.Invalid},p.prototype.finger=function(t){var e=this.pointable(t);return e.tool?r.Invalid:e},p.prototype.hand=function(t){return this.handsMap[t]||n.Invalid},p.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var n=this.rotationMatrix(t),r=.5*(n[0]+n[4]+n[8]-1),o=Math.acos(r);if(o=isNaN(o)?0:o,void 0!==e){var i=this.rotationAxis(t);o*=s.dot(i,s.normalize(s.create(),e))}return o},p.prototype.rotationAxis=function(t){return this.valid&&t.valid?s.normalize(s.create(),[this._rotation[7]-t._rotation[5],this._rotation[2]-t._rotation[6],this._rotation[3]-t._rotation[1]]):s.create()},p.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return a.create();var e=a.transpose(a.create(),this._rotation);return a.multiply(a.create(),t._rotation,e)},p.prototype.scaleFactor=function(t){return this.valid&&t.valid?Math.exp(this._scaleFactor-t._scaleFactor):1},p.prototype.translation=function(t){return this.valid&&t.valid?s.subtract(s.create(),this._translation,t._translation):s.create()},p.prototype.toString=function(){var t="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";return this.gestures&&(t+=" | Gesture count:("+this.gestures.length+")"),t+=" ]"},p.prototype.dump=function(){var t="";t+="Frame Info:<br/>",t+=this.toString(),t+="<br/><br/>Hands:<br/>";for(var e=0,n=this.hands.length;e!=n;e++)t+="  "+this.hands[e].toString()+"<br/>";t+="<br/><br/>Pointables:<br/>";for(var r=0,o=this.pointables.length;r!=o;r++)t+="  "+this.pointables[r].toString()+"<br/>";if(this.gestures){t+="<br/><br/>Gestures:<br/>";for(var i=0,a=this.gestures.length;i!=a;i++)t+="  "+this.gestures[i].toString()+"<br/>"}return t+="<br/><br/>Raw JSON:<br/>",t+=JSON.stringify(this.data)},p.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return r.Invalid},finger:function(){return r.Invalid},hand:function(){return n.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return a.create()},rotationAxis:function(){return s.create()},scaleFactor:function(){return 1},translation:function(){return s.create()}}},{"./finger":7,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"gl-matrix":23,underscore:24}],9:[function(t,e,n){var r=t("gl-matrix"),o=r.vec3,i=t("events").EventEmitter,a=t("underscore"),s=(n.createGesture=function(t){var e;switch(t.type){case"circle":e=new u(t);break;case"swipe":e=new c(t);break;case"screenTap":e=new l(t);break;case"keyTap":e=new p(t);break;default:throw"unknown gesture type"}return e.id=t.id,e.handIds=t.handIds.slice(),e.pointableIds=t.pointableIds.slice(),e.duration=t.duration,e.state=t.state,e.type=t.type,e},n.gestureListener=function(t,e){var n={},r={};t.on("gesture",function(t,o){if(t.type==e){if(("start"==t.state||"stop"==t.state)&&void 0===r[t.id]){var i=new s(t,o);r[t.id]=i,a.each(n,function(t,e){i.on(e,t)})}r[t.id].update(t,o),"stop"==t.state&&delete r[t.id]}});var o={start:function(t){return n.start=t,o},stop:function(t){return n.stop=t,o},complete:function(t){return n.stop=t,o},update:function(t){return n.update=t,o}};return o},n.Gesture=function(t,e){this.gestures=[t],this.frames=[e]});s.prototype.update=function(t,e){this.lastGesture=t,this.lastFrame=e,this.gestures.push(t),this.frames.push(e),this.emit(t.state,this)},s.prototype.translation=function(){return o.subtract(o.create(),this.lastGesture.startPosition,this.lastGesture.position)},a.extend(s.prototype,i.prototype);var u=function(t){this.center=t.center,this.normal=t.normal,this.progress=t.progress,this.radius=t.radius};u.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var c=function(t){this.startPosition=t.startPosition,this.position=t.position,this.direction=t.direction,this.speed=t.speed};c.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var l=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};l.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var p=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};p.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"}},{events:21,"gl-matrix":23,underscore:24}],10:[function(t,e){var n=t("./pointable"),r=t("./bone"),o=t("gl-matrix"),i=o.mat3,a=o.vec3,s=t("underscore"),u=e.exports=function(t){this.id=t.id,this.palmPosition=t.palmPosition,this.direction=t.direction,this.palmVelocity=t.palmVelocity,this.palmNormal=t.palmNormal,this.sphereCenter=t.sphereCenter,this.sphereRadius=t.sphereRadius,this.valid=!0,this.pointables=[],this.fingers=[],this.arm=t.armBasis?new r(this,{type:4,width:t.armWidth,prevJoint:t.elbow,nextJoint:t.wrist,basis:t.armBasis}):null,this.tools=[],this._translation=t.t,this._rotation=s.flatten(t.r),this._scaleFactor=t.s,this.timeVisible=t.timeVisible,this.stabilizedPalmPosition=t.stabilizedPalmPosition,this.type=t.type,this.grabStrength=t.grabStrength,this.pinchStrength=t.pinchStrength,this.confidence=t.confidence};u.prototype.finger=function(t){var e=this.frame.finger(t);return e&&e.handId==this.id?e:n.Invalid},u.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var n=t.hand(this.id);if(!n.valid)return 0;var r=this.rotationMatrix(t),o=.5*(r[0]+r[4]+r[8]-1),i=Math.acos(o);if(i=isNaN(i)?0:i,void 0!==e){var s=this.rotationAxis(t);i*=a.dot(s,a.normalize(a.create(),e))}return i},u.prototype.rotationAxis=function(t){if(!this.valid||!t.valid)return a.create();var e=t.hand(this.id);return e.valid?a.normalize(a.create(),[this._rotation[7]-e._rotation[5],this._rotation[2]-e._rotation[6],this._rotation[3]-e._rotation[1]]):a.create()},u.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return i.create();var e=t.hand(this.id);if(!e.valid)return i.create();var n=i.transpose(i.create(),this._rotation),r=i.multiply(i.create(),e._rotation,n);return r},u.prototype.scaleFactor=function(t){if(!this.valid||!t.valid)return 1;var e=t.hand(this.id);return e.valid?Math.exp(this._scaleFactor-e._scaleFactor):1},u.prototype.translation=function(t){if(!this.valid||!t.valid)return a.create();var e=t.hand(this.id);return e.valid?[this._translation[0]-e._translation[0],this._translation[1]-e._translation[1],this._translation[2]-e._translation[2]]:a.create()},u.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "},u.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])},u.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])},u.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])},u.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return n.Invalid},finger:function(){return n.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return i.create()},rotationAxis:function(){return a.create()},scaleFactor:function(){return 1},translation:function(){return a.create()}}},{"./bone":1,"./pointable":14,"gl-matrix":23,underscore:24}],11:[function(t,e){e.exports={Controller:t("./controller"),Frame:t("./frame"),Gesture:t("./gesture"),Hand:t("./hand"),Pointable:t("./pointable"),Finger:t("./finger"),InteractionBox:t("./interaction_box"),CircularBuffer:t("./circular_buffer"),UI:t("./ui"),JSONProtocol:t("./protocol").JSONProtocol,glMatrix:t("gl-matrix"),mat3:t("gl-matrix").mat3,vec3:t("gl-matrix").vec3,loopController:void 0,version:t("./version.js"),loop:function(t,e){return!t||void 0!==e||t.frame||t.hand||(e=t,t={}),this.loopController?t&&this.loopController.setupFrameEvents(t):this.loopController=new this.Controller(t),this.loopController.loop(e),this.loopController},plugin:function(t,e){this.Controller.plugin(t,e)}}},{"./circular_buffer":2,"./controller":5,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"./protocol":15,"./ui":16,"./version.js":19,"gl-matrix":23}],12:[function(t,e){var n=t("gl-matrix"),r=n.vec3,o=e.exports=function(t){this.valid=!0,this.center=t.center,this.size=t.size,this.width=t.size[0],this.height=t.size[1],this.depth=t.size[2]};o.prototype.denormalizePoint=function(t){return r.fromValues((t[0]-.5)*this.size[0]+this.center[0],(t[1]-.5)*this.size[1]+this.center[1],(t[2]-.5)*this.size[2]+this.center[2])},o.prototype.normalizePoint=function(t,e){var n=r.fromValues((t[0]-this.center[0])/this.size[0]+.5,(t[1]-this.center[1])/this.size[1]+.5,(t[2]-this.center[2])/this.size[2]+.5);return e&&(n[0]=Math.min(Math.max(n[0],0),1),n[1]=Math.min(Math.max(n[1],0),1),n[2]=Math.min(Math.max(n[2],0),1)),n},o.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"},o.Invalid={valid:!1}},{"gl-matrix":23}],13:[function(t,e){var n=e.exports=function(t){this.steps=[],this.controller=t};n.prototype.addStep=function(t){this.steps.push(t)},n.prototype.run=function(t){for(var e=this.steps.length,n=0;n!=e&&t;n++)t=this.steps[n](t);return t},n.prototype.removeStep=function(t){var e=this.steps.indexOf(t);if(-1===e)throw"Step not found in pipeline";this.steps.splice(e,1)},n.prototype.addWrappedStep=function(t,e){var n=this.controller,r=function(r){var o,i,a;for(o="frame"==t?[r]:r[t+"s"]||[],i=0,a=o.length;a>i;i++)e.call(n,o[i]);return r};return this.addStep(r),r}},{}],14:[function(t,e){var n=t("gl-matrix"),r=(n.vec3,e.exports=function(t){this.valid=!0,this.id=t.id,this.handId=t.handId,this.length=t.length,this.tool=t.tool,this.width=t.width,this.direction=t.direction,this.stabilizedTipPosition=t.stabilizedTipPosition,this.tipPosition=t.tipPosition,this.tipVelocity=t.tipVelocity,this.touchZone=t.touchZone,this.touchDistance=t.touchDistance,this.timeVisible=t.timeVisible});r.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},r.prototype.hand=function(){return this.frame.hand(this.handId)},r.Invalid={valid:!1}},{"gl-matrix":23}],15:[function(t,e,n){var r=t("./frame"),o=(t("./hand"),t("./pointable"),t("./finger"),t("underscore")),i=t("events").EventEmitter,a=function(t){this.type=t.type,this.state=t.state};n.chooseProtocol=function(t){var e;switch(t.version){case 1:case 2:case 3:case 4:case 5:case 6:e=s(t),e.sendBackground=function(t,n){t.send(e.encode({background:n}))},e.sendFocused=function(t,n){t.send(e.encode({focused:n}))};break;default:throw"unrecognized version"}return e};var s=n.JSONProtocol=function(t){var e=function(t){if(t.event)return new a(t.event);e.emit("beforeFrameCreated",t);var n=new r(t);return e.emit("afterFrameCreated",n,t),n};return e.encode=function(t){return JSON.stringify(t)},e.version=t.version,e.serviceVersion=t.serviceVersion,e.versionLong="Version "+t.version,e.type="protocol",o.extend(e,i.prototype),e}},{"./finger":7,"./frame":8,"./hand":10,"./pointable":14,events:21,underscore:24}],16:[function(t,e,n){n.UI={Region:t("./ui/region"),Cursor:t("./ui/cursor")}},{"./ui/cursor":17,"./ui/region":18}],17:[function(t,e){e.exports=function(){return function(t){var e=t.pointables.sort(function(t,e){return t.z-e.z})[0];return e&&e.valid&&(t.cursorPosition=e.tipPosition),t}}},{}],18:[function(t,e){var n=t("events").EventEmitter,r=t("underscore"),o=e.exports=function(t,e){this.start=new Vector(t),this.end=new Vector(e),this.enteredFrame=null};o.prototype.hasPointables=function(t){for(var e=0;e!=t.pointables.length;e++){var n=t.pointables[e].tipPosition;if(n.x>=this.start.x&&n.x<=this.end.x&&n.y>=this.start.y&&n.y<=this.end.y&&n.z>=this.start.z&&n.z<=this.end.z)return!0}return!1},o.prototype.listener=function(t){var e=this;return t&&t.nearThreshold&&this.setupNearRegion(t.nearThreshold),function(t){return e.updatePosition(t)}},o.prototype.clipper=function(){var t=this;return function(e){return t.updatePosition(e),t.enteredFrame?e:null}},o.prototype.setupNearRegion=function(t){var e=this.nearRegion=new o([this.start.x-t,this.start.y-t,this.start.z-t],[this.end.x+t,this.end.y+t,this.end.z+t]),n=this;e.on("enter",function(t){n.emit("near",t)}),e.on("exit",function(t){n.emit("far",t)}),n.on("exit",function(t){n.emit("near",t)})},o.prototype.updatePosition=function(t){return this.nearRegion&&this.nearRegion.updatePosition(t),this.hasPointables(t)&&null==this.enteredFrame?(this.enteredFrame=t,this.emit("enter",this.enteredFrame)):this.hasPointables(t)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame)),t},o.prototype.normalize=function(t){return new Vector([(t.x-this.start.x)/(this.end.x-this.start.x),(t.y-this.start.y)/(this.end.y-this.start.y),(t.z-this.start.z)/(this.end.z-this.start.z)])},o.prototype.mapToXY=function(t,e,n){var r=this.normalize(t),o=r.x,i=r.y;return o>1?o=1:-1>o&&(o=-1),i>1?i=1:-1>i&&(i=-1),[(o+1)/2*e,(1-i)/2*n,r.z]},r.extend(o.prototype,n.prototype)},{events:21,underscore:24}],19:[function(t,e){e.exports={full:"0.6.2",major:0,minor:6,dot:2}},{}],20:[function(){},{}],21:[function(t,e,n){function r(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}var o=t("__browserify_process");o.EventEmitter||(o.EventEmitter=function(){});var i=n.EventEmitter=o.EventEmitter,a="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=10;i.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},i.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||a(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(a(e)){for(var n=Array.prototype.slice.call(arguments,1),r=e.slice(),o=0,i=r.length;i>o;o++)r[o].apply(this,n);return!0}return!1},i.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(a(this._events[t])){if(!this._events[t].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:s,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0)}this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){var n=this;return n.on(t,function r(){n.removeListener(t,r),e.apply(this,arguments)}),this},i.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(a(n)){var o=r(n,e);if(0>o)return this;n.splice(o,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},i.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},i.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),a(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},i.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?"function"==typeof t._events[e]?1:t._events[e].length:0}},{__browserify_process:22}],22:[function(t,e){var n=e.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],23:[function(t,e,n){!function(t){"use strict";var e={};"undefined"==typeof n?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e.exports={},define(function(){return e.exports})):e.exports="undefined"!=typeof window?window:t:e.exports=n,function(t){if(!e)var e=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!r)var r=Math.random;var o={};o.setMatrixArrayType=function(t){n=t},"undefined"!=typeof t&&(t.glMatrix=o);var i=Math.PI/180;o.toRadian=function(t){return t*i};var a={};a.create=function(){var t=new n(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new n(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var r=new n(2);return r[0]=t,r[1]=e,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,n){return t[0]=e,t[1]=n,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},a.div=a.divide,a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.normalize=function(t,e){var n=e[0],r=e[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},a.lerp=function(t,e,n,r){var o=e[0],i=e[1];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t},a.random=function(t,e){e=e||1;var n=2*r()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},a.transformMat2=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t},a.transformMat2d=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o+n[4],t[1]=n[1]*r+n[3]*o+n[5],t},a.transformMat3=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[3]*o+n[6],t[1]=n[1]*r+n[4]*o+n[7],t},a.transformMat4=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[4]*o+n[12],t[1]=n[1]*r+n[5]*o+n[13],t},a.forEach=function(){var t=a.create();return function(e,n,r,o,i,a){var s,u;for(n||(n=2),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],i(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=a);var s={};s.create=function(){var t=new n(3);return t[0]=0,t[1]=0,t[2]=0,t},s.clone=function(t){var e=new n(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},s.fromValues=function(t,e,r){var o=new n(3);return o[0]=t,o[1]=e,o[2]=r,o},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},s.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},s.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},s.sub=s.subtract,s.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},s.mul=s.multiply,s.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},s.div=s.divide,s.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},s.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},s.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},s.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},s.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},s.dist=s.distance,s.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},s.len=s.length,s.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},s.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},s.cross=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],u=n[2];return t[0]=o*u-i*s,t[1]=i*a-r*u,t[2]=r*s-o*a,t},s.lerp=function(t,e,n,r){var o=e[0],i=e[1],a=e[2];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t},s.random=function(t,e){e=e||1;var n=2*r()*Math.PI,o=2*r()-1,i=Math.sqrt(1-o*o)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=o*e,t},s.transformMat4=function(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12],t[1]=n[1]*r+n[5]*o+n[9]*i+n[13],t[2]=n[2]*r+n[6]*o+n[10]*i+n[14],t},s.transformMat3=function(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=r*n[0]+o*n[3]+i*n[6],t[1]=r*n[1]+o*n[4]+i*n[7],t[2]=r*n[2]+o*n[5]+i*n[8],t},s.transformQuat=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*i-u*o,p=c*o+u*r-a*i,h=c*i+a*o-s*r,d=-a*r-s*o-u*i;return t[0]=l*c+d*-a+p*-u-h*-s,t[1]=p*c+d*-s+h*-a-l*-u,t[2]=h*c+d*-u+l*-s-p*-a,t},s.rotateX=function(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[0],i[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),i[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},s.rotateY=function(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),i[1]=o[1],i[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},s.rotateZ=function(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),i[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),i[2]=o[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},s.forEach=function(){var t=s.create();return function(e,n,r,o,i,a){var s,u;for(n||(n=3),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],i(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),s.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=s);var u={};u.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},u.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.fromValues=function(t,e,r,o){var i=new n(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=o,i},u.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},u.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},u.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},u.sub=u.subtract,u.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},u.mul=u.multiply,u.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},u.div=u.divide,u.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},u.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},u.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},u.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},u.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(n*n+r*r+o*o+i*i)},u.dist=u.distance,u.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+o*o+i*i},u.sqrDist=u.squaredDistance,u.length=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return Math.sqrt(e*e+n*n+r*r+o*o)},u.len=u.length,u.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o},u.sqrLen=u.squaredLength,u.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},u.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a),t},u.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},u.lerp=function(t,e,n,r){var o=e[0],i=e[1],a=e[2],s=e[3];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t},u.random=function(t,e){return e=e||1,t[0]=r(),t[1]=r(),t[2]=r(),t[3]=r(),u.normalize(t,t),u.scale(t,t,e),t},u.transformMat4=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*a,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*a,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*a,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*a,t},u.transformQuat=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*i-u*o,p=c*o+u*r-a*i,h=c*i+a*o-s*r,d=-a*r-s*o-u*i;return t[0]=l*c+d*-a+p*-u-h*-s,t[1]=p*c+d*-s+h*-a-l*-u,t[2]=h*c+d*-u+l*-s-p*-a,t},u.forEach=function(){var t=u.create();return function(e,n,r,o,i,a){var s,u;for(n||(n=4),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],i(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=u);var c={};c.create=function(){var t=new n(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},c.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*i-o*r;return a?(a=1/a,t[0]=i*a,t[1]=-r*a,t[2]=-o*a,t[3]=n*a,t):null},c.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},c.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},c.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*s+i*u,t[1]=o*s+a*u,t[2]=r*c+i*l,t[3]=o*c+a*l,t},c.mul=c.multiply,c.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=o*u+a*s,t[2]=r*-s+i*u,t[3]=o*-s+a*u,t},c.scale=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=o*s,t[2]=i*u,t[3]=a*u,t},c.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},c.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},"undefined"!=typeof t&&(t.mat2=c);var l={};l.create=function(){var t=new n(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.clone=function(t){var e=new n(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=n*i-r*o;return u?(u=1/u,t[0]=i*u,t[1]=-r*u,t[2]=-o*u,t[3]=n*u,t[4]=(o*s-i*a)*u,t[5]=(r*a-n*s)*u,t):null},l.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},l.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1],p=n[2],h=n[3],d=n[4],f=n[5];return t[0]=r*c+i*l,t[1]=o*c+a*l,t[2]=r*p+i*h,t[3]=o*p+a*h,t[4]=r*d+i*f+s,t[5]=o*d+a*f+u,t},l.mul=l.multiply,l.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*c,t[1]=o*l+a*c,t[2]=r*-c+i*l,t[3]=o*-c+a*l,t[4]=s,t[5]=u,t},l.scale=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r*c,t[1]=o*c,t[2]=i*l,t[3]=a*l,t[4]=s,t[5]=u,t},l.translate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=r*c+i*l+s,t[5]=o*c+a*l+u,t},l.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},l.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof t&&(t.mat2d=l);var p={};p.create=function(){var t=new n(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},p.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},p.clone=function(t){var e=new n(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},p.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},p.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},p.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},p.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],p=l*a-s*c,h=-l*i+s*u,d=c*i-a*u,f=n*p+r*h+o*d;return f?(f=1/f,t[0]=p*f,t[1]=(-l*r+o*c)*f,t[2]=(s*r-o*a)*f,t[3]=h*f,t[4]=(l*n-o*u)*f,t[5]=(-s*n+o*i)*f,t[6]=d*f,t[7]=(-c*n+r*u)*f,t[8]=(a*n-r*i)*f,t):null},p.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=a*l-s*c,t[1]=o*c-r*l,t[2]=r*s-o*a,t[3]=s*u-i*l,t[4]=n*l-o*u,t[5]=o*i-n*s,t[6]=i*c-a*u,t[7]=r*u-n*c,t[8]=n*a-r*i,t},p.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*i-a*u)+n*(-c*o+a*s)+r*(u*o-i*s)},p.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],p=e[8],h=n[0],d=n[1],f=n[2],m=n[3],v=n[4],g=n[5],y=n[6],w=n[7],b=n[8];
return t[0]=h*r+d*a+f*c,t[1]=h*o+d*s+f*l,t[2]=h*i+d*u+f*p,t[3]=m*r+v*a+g*c,t[4]=m*o+v*s+g*l,t[5]=m*i+v*u+g*p,t[6]=y*r+w*a+b*c,t[7]=y*o+w*s+b*l,t[8]=y*i+w*u+b*p,t},p.mul=p.multiply,p.translate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],p=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=s,t[5]=u,t[6]=h*r+d*a+c,t[7]=h*o+d*s+l,t[8]=h*i+d*u+p,t},p.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],p=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*a,t[1]=d*o+h*s,t[2]=d*i+h*u,t[3]=d*a-h*r,t[4]=d*s-h*o,t[5]=d*u-h*i,t[6]=c,t[7]=l,t[8]=p,t},p.scale=function(t,e,n){var r=n[0],o=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},p.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},p.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,s=r+r,u=o+o,c=n*a,l=r*a,p=r*s,h=o*a,d=o*s,f=o*u,m=i*a,v=i*s,g=i*u;return t[0]=1-p-f,t[3]=l-g,t[6]=h+v,t[1]=l+g,t[4]=1-c-f,t[7]=d-m,t[2]=h-v,t[5]=d+m,t[8]=1-c-p,t},p.normalFromMat4=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],p=e[9],h=e[10],d=e[11],f=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*a,w=n*u-o*a,b=n*c-i*a,M=r*u-o*s,C=r*c-i*s,x=o*c-i*u,_=l*m-p*f,S=l*v-h*f,L=l*g-d*f,P=p*v-h*m,k=p*g-d*m,E=h*g-d*v,I=y*E-w*k+b*P+M*L-C*S+x*_;return I?(I=1/I,t[0]=(s*E-u*k+c*P)*I,t[1]=(u*L-a*E-c*S)*I,t[2]=(a*k-s*L+c*_)*I,t[3]=(o*k-r*E-i*P)*I,t[4]=(n*E-o*L+i*S)*I,t[5]=(r*L-n*k-i*_)*I,t[6]=(m*x-v*C+g*M)*I,t[7]=(v*b-f*x-g*w)*I,t[8]=(f*C-m*b+g*y)*I,t):null},p.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},p.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof t&&(t.mat3=p);var h={};h.create=function(){var t=new n(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},h.clone=function(t){var e=new n(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},h.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},h.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},h.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[3],i=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=o,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},h.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],p=e[9],h=e[10],d=e[11],f=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*a,w=n*u-o*a,b=n*c-i*a,M=r*u-o*s,C=r*c-i*s,x=o*c-i*u,_=l*m-p*f,S=l*v-h*f,L=l*g-d*f,P=p*v-h*m,k=p*g-d*m,E=h*g-d*v,I=y*E-w*k+b*P+M*L-C*S+x*_;return I?(I=1/I,t[0]=(s*E-u*k+c*P)*I,t[1]=(o*k-r*E-i*P)*I,t[2]=(m*x-v*C+g*M)*I,t[3]=(h*C-p*x-d*M)*I,t[4]=(u*L-a*E-c*S)*I,t[5]=(n*E-o*L+i*S)*I,t[6]=(v*b-f*x-g*w)*I,t[7]=(l*x-h*b+d*w)*I,t[8]=(a*k-s*L+c*_)*I,t[9]=(r*L-n*k-i*_)*I,t[10]=(f*C-m*b+g*y)*I,t[11]=(p*b-l*C-d*y)*I,t[12]=(s*S-a*P-u*_)*I,t[13]=(n*P-r*S+o*_)*I,t[14]=(m*w-f*M-v*y)*I,t[15]=(l*M-p*w+h*y)*I,t):null},h.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],p=e[9],h=e[10],d=e[11],f=e[12],m=e[13],v=e[14],g=e[15];return t[0]=s*(h*g-d*v)-p*(u*g-c*v)+m*(u*d-c*h),t[1]=-(r*(h*g-d*v)-p*(o*g-i*v)+m*(o*d-i*h)),t[2]=r*(u*g-c*v)-s*(o*g-i*v)+m*(o*c-i*u),t[3]=-(r*(u*d-c*h)-s*(o*d-i*h)+p*(o*c-i*u)),t[4]=-(a*(h*g-d*v)-l*(u*g-c*v)+f*(u*d-c*h)),t[5]=n*(h*g-d*v)-l*(o*g-i*v)+f*(o*d-i*h),t[6]=-(n*(u*g-c*v)-a*(o*g-i*v)+f*(o*c-i*u)),t[7]=n*(u*d-c*h)-a*(o*d-i*h)+l*(o*c-i*u),t[8]=a*(p*g-d*m)-l*(s*g-c*m)+f*(s*d-c*p),t[9]=-(n*(p*g-d*m)-l*(r*g-i*m)+f*(r*d-i*p)),t[10]=n*(s*g-c*m)-a*(r*g-i*m)+f*(r*c-i*s),t[11]=-(n*(s*d-c*p)-a*(r*d-i*p)+l*(r*c-i*s)),t[12]=-(a*(p*v-h*m)-l*(s*v-u*m)+f*(s*h-u*p)),t[13]=n*(p*v-h*m)-l*(r*v-o*m)+f*(r*h-o*p),t[14]=-(n*(s*v-u*m)-a*(r*v-o*m)+f*(r*u-o*s)),t[15]=n*(s*h-u*p)-a*(r*h-o*p)+l*(r*u-o*s),t},h.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],p=t[10],h=t[11],d=t[12],f=t[13],m=t[14],v=t[15],g=e*a-n*i,y=e*s-r*i,w=e*u-o*i,b=n*s-r*a,M=n*u-o*a,C=r*u-o*s,x=c*f-l*d,_=c*m-p*d,S=c*v-h*d,L=l*m-p*f,P=l*v-h*f,k=p*v-h*m;return g*k-y*P+w*L+b*S-M*_+C*x},h.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],p=e[8],h=e[9],d=e[10],f=e[11],m=e[12],v=e[13],g=e[14],y=e[15],w=n[0],b=n[1],M=n[2],C=n[3];return t[0]=w*r+b*s+M*p+C*m,t[1]=w*o+b*u+M*h+C*v,t[2]=w*i+b*c+M*d+C*g,t[3]=w*a+b*l+M*f+C*y,w=n[4],b=n[5],M=n[6],C=n[7],t[4]=w*r+b*s+M*p+C*m,t[5]=w*o+b*u+M*h+C*v,t[6]=w*i+b*c+M*d+C*g,t[7]=w*a+b*l+M*f+C*y,w=n[8],b=n[9],M=n[10],C=n[11],t[8]=w*r+b*s+M*p+C*m,t[9]=w*o+b*u+M*h+C*v,t[10]=w*i+b*c+M*d+C*g,t[11]=w*a+b*l+M*f+C*y,w=n[12],b=n[13],M=n[14],C=n[15],t[12]=w*r+b*s+M*p+C*m,t[13]=w*o+b*u+M*h+C*v,t[14]=w*i+b*c+M*d+C*g,t[15]=w*a+b*l+M*f+C*y,t},h.mul=h.multiply,h.translate=function(t,e,n){var r,o,i,a,s,u,c,l,p,h,d,f,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=r*m+s*v+p*g+e[12],t[13]=o*m+u*v+h*g+e[13],t[14]=i*m+c*v+d*g+e[14],t[15]=a*m+l*v+f*g+e[15]),t},h.scale=function(t,e,n){var r=n[0],o=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},h.rotate=function(t,n,r,o){var i,a,s,u,c,l,p,h,d,f,m,v,g,y,w,b,M,C,x,_,S,L,P,k,E=o[0],I=o[1],V=o[2],F=Math.sqrt(E*E+I*I+V*V);return Math.abs(F)<e?null:(F=1/F,E*=F,I*=F,V*=F,i=Math.sin(r),a=Math.cos(r),s=1-a,u=n[0],c=n[1],l=n[2],p=n[3],h=n[4],d=n[5],f=n[6],m=n[7],v=n[8],g=n[9],y=n[10],w=n[11],b=E*E*s+a,M=I*E*s+V*i,C=V*E*s-I*i,x=E*I*s-V*i,_=I*I*s+a,S=V*I*s+E*i,L=E*V*s+I*i,P=I*V*s-E*i,k=V*V*s+a,t[0]=u*b+h*M+v*C,t[1]=c*b+d*M+g*C,t[2]=l*b+f*M+y*C,t[3]=p*b+m*M+w*C,t[4]=u*x+h*_+v*S,t[5]=c*x+d*_+g*S,t[6]=l*x+f*_+y*S,t[7]=p*x+m*_+w*S,t[8]=u*L+h*P+v*k,t[9]=c*L+d*P+g*k,t[10]=l*L+f*P+y*k,t[11]=p*L+m*P+w*k,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},h.rotateX=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*o+c*r,t[5]=a*o+l*r,t[6]=s*o+p*r,t[7]=u*o+h*r,t[8]=c*o-i*r,t[9]=l*o-a*r,t[10]=p*o-s*r,t[11]=h*o-u*r,t},h.rotateY=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],p=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o-c*r,t[1]=a*o-l*r,t[2]=s*o-p*r,t[3]=u*o-h*r,t[8]=i*r+c*o,t[9]=a*r+l*o,t[10]=s*r+p*o,t[11]=u*r+h*o,t},h.rotateZ=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o+c*r,t[1]=a*o+l*r,t[2]=s*o+p*r,t[3]=u*o+h*r,t[4]=c*o-i*r,t[5]=l*o-a*r,t[6]=p*o-s*r,t[7]=h*o-u*r,t},h.fromRotationTranslation=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=r+r,u=o+o,c=i+i,l=r*s,p=r*u,h=r*c,d=o*u,f=o*c,m=i*c,v=a*s,g=a*u,y=a*c;return t[0]=1-(d+m),t[1]=p+y,t[2]=h-g,t[3]=0,t[4]=p-y,t[5]=1-(l+m),t[6]=f+v,t[7]=0,t[8]=h+g,t[9]=f-v,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},h.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,s=r+r,u=o+o,c=n*a,l=r*a,p=r*s,h=o*a,d=o*s,f=o*u,m=i*a,v=i*s,g=i*u;return t[0]=1-p-f,t[1]=l+g,t[2]=h-v,t[3]=0,t[4]=l-g,t[5]=1-c-f,t[6]=d+m,t[7]=0,t[8]=h+v,t[9]=d-m,t[10]=1-c-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},h.frustum=function(t,e,n,r,o,i,a){var s=1/(n-e),u=1/(o-r),c=1/(i-a);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(o+r)*u,t[10]=(a+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*c,t[15]=0,t},h.perspective=function(t,e,n,r,o){var i=1/Math.tan(e/2),a=1/(r-o);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*r*a,t[15]=0,t},h.ortho=function(t,e,n,r,o,i,a){var s=1/(e-n),u=1/(r-o),c=1/(i-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(o+r)*u,t[14]=(a+i)*c,t[15]=1,t},h.lookAt=function(t,n,r,o){var i,a,s,u,c,l,p,d,f,m,v=n[0],g=n[1],y=n[2],w=o[0],b=o[1],M=o[2],C=r[0],x=r[1],_=r[2];return Math.abs(v-C)<e&&Math.abs(g-x)<e&&Math.abs(y-_)<e?h.identity(t):(p=v-C,d=g-x,f=y-_,m=1/Math.sqrt(p*p+d*d+f*f),p*=m,d*=m,f*=m,i=b*f-M*d,a=M*p-w*f,s=w*d-b*p,m=Math.sqrt(i*i+a*a+s*s),m?(m=1/m,i*=m,a*=m,s*=m):(i=0,a=0,s=0),u=d*s-f*a,c=f*i-p*s,l=p*a-d*i,m=Math.sqrt(u*u+c*c+l*l),m?(m=1/m,u*=m,c*=m,l*=m):(u=0,c=0,l=0),t[0]=i,t[1]=u,t[2]=p,t[3]=0,t[4]=a,t[5]=c,t[6]=d,t[7]=0,t[8]=s,t[9]=l,t[10]=f,t[11]=0,t[12]=-(i*v+a*g+s*y),t[13]=-(u*v+c*g+l*y),t[14]=-(p*v+d*g+f*y),t[15]=1,t)},h.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof t&&(t.mat4=h);var d={};d.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.rotationTo=function(){var t=s.create(),e=s.fromValues(1,0,0),n=s.fromValues(0,1,0);return function(r,o,i){var a=s.dot(o,i);return-.999999>a?(s.cross(t,e,o),s.length(t)<1e-6&&s.cross(t,n,o),s.normalize(t,t),d.setAxisAngle(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(s.cross(t,o,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,d.normalize(r,r))}}(),d.setAxes=function(){var t=p.create();return function(e,n,r,o){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=o[0],t[4]=o[1],t[7]=o[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],d.normalize(e,d.fromMat3(e,t))}}(),d.clone=u.clone,d.fromValues=u.fromValues,d.copy=u.copy,d.set=u.set,d.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.setAxisAngle=function(t,e,n){n=.5*n;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},d.add=u.add,d.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+o*c-i*u,t[1]=o*l+a*u+i*s-r*c,t[2]=i*l+a*c+r*u-o*s,t[3]=a*l-r*s-o*u-i*c,t},d.mul=d.multiply,d.scale=u.scale,d.rotateX=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=o*u+i*s,t[2]=i*u-o*s,t[3]=a*u-r*s,t},d.rotateY=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-i*s,t[1]=o*u+a*s,t[2]=i*u+r*s,t[3]=a*u-o*s,t},d.rotateZ=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=o*u-r*s,t[2]=i*u+a*s,t[3]=a*u-i*s,t},d.calculateW=function(t,e){var n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t},d.dot=u.dot,d.lerp=u.lerp,d.slerp=function(t,e,n,r){var o,i,a,s,u,c=e[0],l=e[1],p=e[2],h=e[3],d=n[0],f=n[1],m=n[2],v=n[3];return i=c*d+l*f+p*m+h*v,0>i&&(i=-i,d=-d,f=-f,m=-m,v=-v),1-i>1e-6?(o=Math.acos(i),a=Math.sin(o),s=Math.sin((1-r)*o)/a,u=Math.sin(r*o)/a):(s=1-r,u=r),t[0]=s*c+u*d,t[1]=s*l+u*f,t[2]=s*p+u*m,t[3]=s*h+u*v,t},d.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-o*s,t[3]=i*s,t},d.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},d.length=u.length,d.len=d.length,d.squaredLength=u.squaredLength,d.sqrLen=d.squaredLength,d.normalize=u.normalize,d.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[7]-e[5])*n,t[1]=(e[2]-e[6])*n,t[2]=(e[3]-e[1])*n;else{var o=0;e[4]>e[0]&&(o=1),e[8]>e[3*o+o]&&(o=2);var i=(o+1)%3,a=(o+2)%3;n=Math.sqrt(e[3*o+o]-e[3*i+i]-e[3*a+a]+1),t[o]=.5*n,n=.5/n,t[3]=(e[3*a+i]-e[3*i+a])*n,t[i]=(e[3*i+o]+e[3*o+i])*n,t[a]=(e[3*a+o]+e[3*o+a])*n}return t},d.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=d)}(e.exports)}(this)},{}],24:[function(t,e,n){(function(){var t=this,r=t._,o={},i=Array.prototype,a=Object.prototype,s=Function.prototype,u=i.push,c=i.slice,l=i.concat,p=a.toString,h=a.hasOwnProperty,d=i.forEach,f=i.map,m=i.reduce,v=i.reduceRight,g=i.filter,y=i.every,w=i.some,b=i.indexOf,M=i.lastIndexOf,C=Array.isArray,x=Object.keys,_=s.bind,S=function(t){return t instanceof S?t:this instanceof S?void(this._wrapped=t):new S(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=S),n._=S):t._=S,S.VERSION="1.4.4";var L=S.each=S.forEach=function(t,e,n){if(null!=t)if(d&&t.forEach===d)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,i=t.length;i>r;r++)if(e.call(n,t[r],r,t)===o)return}else for(var a in t)if(S.has(t,a)&&e.call(n,t[a],a,t)===o)return};S.map=S.collect=function(t,e,n){var r=[];return null==t?r:f&&t.map===f?t.map(e,n):(L(t,function(t,o,i){r[r.length]=e.call(n,t,o,i)}),r)};var P="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(t,e,n,r){var o=arguments.length>2;if(null==t&&(t=[]),m&&t.reduce===m)return r&&(e=S.bind(e,r)),o?t.reduce(e,n):t.reduce(e);if(L(t,function(t,i,a){o?n=e.call(r,n,t,i,a):(n=t,o=!0)}),!o)throw new TypeError(P);return n},S.reduceRight=S.foldr=function(t,e,n,r){var o=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return r&&(e=S.bind(e,r)),o?t.reduceRight(e,n):t.reduceRight(e);var i=t.length;if(i!==+i){var a=S.keys(t);i=a.length}if(L(t,function(s,u,c){u=a?a[--i]:--i,o?n=e.call(r,n,t[u],u,c):(n=t[u],o=!0)}),!o)throw new TypeError(P);return n},S.find=S.detect=function(t,e,n){var r;return k(t,function(t,o,i){return e.call(n,t,o,i)?(r=t,!0):void 0}),r},S.filter=S.select=function(t,e,n){var r=[];return null==t?r:g&&t.filter===g?t.filter(e,n):(L(t,function(t,o,i){e.call(n,t,o,i)&&(r[r.length]=t)}),r)},S.reject=function(t,e,n){return S.filter(t,function(t,r,o){return!e.call(n,t,r,o)},n)},S.every=S.all=function(t,e,n){e||(e=S.identity);var r=!0;return null==t?r:y&&t.every===y?t.every(e,n):(L(t,function(t,i,a){return(r=r&&e.call(n,t,i,a))?void 0:o}),!!r)};var k=S.some=S.any=function(t,e,n){e||(e=S.identity);var r=!1;return null==t?r:w&&t.some===w?t.some(e,n):(L(t,function(t,i,a){return r||(r=e.call(n,t,i,a))?o:void 0}),!!r)};S.contains=S.include=function(t,e){return null==t?!1:b&&t.indexOf===b?-1!=t.indexOf(e):k(t,function(t){return t===e})},S.invoke=function(t,e){var n=c.call(arguments,2),r=S.isFunction(e);return S.map(t,function(t){return(r?e:t[e]).apply(t,n)})},S.pluck=function(t,e){return S.map(t,function(t){return t[e]})},S.where=function(t,e,n){return S.isEmpty(e)?n?null:[]:S[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},S.findWhere=function(t,e){return S.where(t,e,!0)},S.max=function(t,e,n){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&S.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return L(t,function(t,o,i){var a=e?e.call(n,t,o,i):t;a>=r.computed&&(r={value:t,computed:a})}),r.value},S.min=function(t,e,n){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&S.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return L(t,function(t,o,i){var a=e?e.call(n,t,o,i):t;a<r.computed&&(r={value:t,computed:a})}),r.value},S.shuffle=function(t){var e,n=0,r=[];return L(t,function(t){e=S.random(n++),r[n-1]=r[e],r[e]=t}),r};var E=function(t){return S.isFunction(t)?t:function(e){return e[t]}};S.sortBy=function(t,e,n){var r=E(e);return S.pluck(S.map(t,function(t,e,o){return{value:t,index:e,criteria:r.call(n,t,e,o)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var I=function(t,e,n,r){var o={},i=E(e||S.identity);return L(t,function(e,a){var s=i.call(n,e,a,t);r(o,s,e)}),o};S.groupBy=function(t,e,n){return I(t,e,n,function(t,e,n){(S.has(t,e)?t[e]:t[e]=[]).push(n)})},S.countBy=function(t,e,n){return I(t,e,n,function(t,e){S.has(t,e)||(t[e]=0),t[e]++})},S.sortedIndex=function(t,e,n,r){n=null==n?S.identity:E(n);for(var o=n.call(r,e),i=0,a=t.length;a>i;){var s=i+a>>>1;n.call(r,t[s])<o?i=s+1:a=s}return i},S.toArray=function(t){return t?S.isArray(t)?c.call(t):t.length===+t.length?S.map(t,S.identity):S.values(t):[]},S.size=function(t){return null==t?0:t.length===+t.length?t.length:S.keys(t).length},S.first=S.head=S.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:c.call(t,0,e)},S.initial=function(t,e,n){return c.call(t,0,t.length-(null==e||n?1:e))},S.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:c.call(t,Math.max(t.length-e,0))},S.rest=S.tail=S.drop=function(t,e,n){return c.call(t,null==e||n?1:e)},S.compact=function(t){return S.filter(t,S.identity)};var V=function(t,e,n){return L(t,function(t){S.isArray(t)?e?u.apply(n,t):V(t,e,n):n.push(t)}),n};S.flatten=function(t,e){return V(t,e,[])},S.without=function(t){return S.difference(t,c.call(arguments,1))},S.uniq=S.unique=function(t,e,n,r){S.isFunction(e)&&(r=n,n=e,e=!1);var o=n?S.map(t,n,r):t,i=[],a=[];return L(o,function(n,r){(e?r&&a[a.length-1]===n:S.contains(a,n))||(a.push(n),i.push(t[r]))}),i},S.union=function(){return S.uniq(l.apply(i,arguments))},S.intersection=function(t){var e=c.call(arguments,1);return S.filter(S.uniq(t),function(t){return S.every(e,function(e){return S.indexOf(e,t)>=0})})},S.difference=function(t){var e=l.apply(i,c.call(arguments,1));return S.filter(t,function(t){return!S.contains(e,t)})},S.zip=function(){for(var t=c.call(arguments),e=S.max(S.pluck(t,"length")),n=new Array(e),r=0;e>r;r++)n[r]=S.pluck(t,""+r);return n},S.object=function(t,e){if(null==t)return{};for(var n={},r=0,o=t.length;o>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},S.indexOf=function(t,e,n){if(null==t)return-1;var r=0,o=t.length;if(n){if("number"!=typeof n)return r=S.sortedIndex(t,e),t[r]===e?r:-1;r=0>n?Math.max(0,o+n):n}if(b&&t.indexOf===b)return t.indexOf(e,n);for(;o>r;r++)if(t[r]===e)return r;return-1},S.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(M&&t.lastIndexOf===M)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var o=r?n:t.length;o--;)if(t[o]===e)return o;return-1},S.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),o=0,i=new Array(r);r>o;)i[o++]=t,t+=n;return i},S.bind=function(t,e){if(t.bind===_&&_)return _.apply(t,c.call(arguments,1));var n=c.call(arguments,2);return function(){return t.apply(e,n.concat(c.call(arguments)))}},S.partial=function(t){var e=c.call(arguments,1);return function(){return t.apply(this,e.concat(c.call(arguments)))}},S.bindAll=function(t){var e=c.call(arguments,1);return 0===e.length&&(e=S.functions(t)),L(e,function(e){t[e]=S.bind(t[e],t)}),t},S.memoize=function(t,e){var n={};return e||(e=S.identity),function(){var r=e.apply(this,arguments);return S.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},S.delay=function(t,e){var n=c.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},S.defer=function(t){return S.delay.apply(S,[t,1].concat(c.call(arguments,1)))},S.throttle=function(t,e){var n,r,o,i,a=0,s=function(){a=new Date,o=null,i=t.apply(n,r)};return function(){var u=new Date,c=e-(u-a);return n=this,r=arguments,0>=c?(clearTimeout(o),o=null,a=u,i=t.apply(n,r)):o||(o=setTimeout(s,c)),i}},S.debounce=function(t,e,n){var r,o;return function(){var i=this,a=arguments,s=function(){r=null,n||(o=t.apply(i,a))},u=n&&!r;return clearTimeout(r),r=setTimeout(s,e),u&&(o=t.apply(i,a)),o}},S.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},S.wrap=function(t,e){return function(){var n=[t];return u.apply(n,arguments),e.apply(this,n)}},S.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},S.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},S.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)S.has(t,n)&&(e[e.length]=n);return e},S.values=function(t){var e=[];for(var n in t)S.has(t,n)&&e.push(t[n]);return e},S.pairs=function(t){var e=[];for(var n in t)S.has(t,n)&&e.push([n,t[n]]);return e},S.invert=function(t){var e={};for(var n in t)S.has(t,n)&&(e[t[n]]=n);return e},S.functions=S.methods=function(t){var e=[];for(var n in t)S.isFunction(t[n])&&e.push(n);return e.sort()},S.extend=function(t){return L(c.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},S.pick=function(t){var e={},n=l.apply(i,c.call(arguments,1));return L(n,function(n){n in t&&(e[n]=t[n])}),e},S.omit=function(t){var e={},n=l.apply(i,c.call(arguments,1));for(var r in t)S.contains(n,r)||(e[r]=t[r]);return e},S.defaults=function(t){return L(c.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},S.clone=function(t){return S.isObject(t)?S.isArray(t)?t.slice():S.extend({},t):t},S.tap=function(t,e){return e(t),t};var F=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof S&&(t=t._wrapped),e instanceof S&&(e=e._wrapped);var o=p.call(t);if(o!=p.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var i=n.length;i--;)if(n[i]==t)return r[i]==e;n.push(t),r.push(e);var a=0,s=!0;if("[object Array]"==o){if(a=t.length,s=a==e.length)for(;a--&&(s=F(t[a],e[a],n,r)););}else{var u=t.constructor,c=e.constructor;if(u!==c&&!(S.isFunction(u)&&u instanceof u&&S.isFunction(c)&&c instanceof c))return!1;for(var l in t)if(S.has(t,l)&&(a++,!(s=S.has(e,l)&&F(t[l],e[l],n,r))))break;if(s){for(l in e)if(S.has(e,l)&&!a--)break;s=!a}}return n.pop(),r.pop(),s};S.isEqual=function(t,e){return F(t,e,[],[])},S.isEmpty=function(t){if(null==t)return!0;if(S.isArray(t)||S.isString(t))return 0===t.length;for(var e in t)if(S.has(t,e))return!1;return!0},S.isElement=function(t){return!(!t||1!==t.nodeType)},S.isArray=C||function(t){return"[object Array]"==p.call(t)},S.isObject=function(t){return t===Object(t)},L(["Arguments","Function","String","Number","Date","RegExp"],function(t){S["is"+t]=function(e){return p.call(e)=="[object "+t+"]"}}),S.isArguments(arguments)||(S.isArguments=function(t){return!(!t||!S.has(t,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(t){return"function"==typeof t}),S.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},S.isNaN=function(t){return S.isNumber(t)&&t!=+t},S.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==p.call(t)},S.isNull=function(t){return null===t},S.isUndefined=function(t){return void 0===t},S.has=function(t,e){return h.call(t,e)},S.noConflict=function(){return t._=r,this},S.identity=function(t){return t},S.times=function(t,e,n){for(var r=Array(t),o=0;t>o;o++)r[o]=e.call(n,o);return r},S.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};A.unescape=S.invert(A.escape);var T={escape:new RegExp("["+S.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(A.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(t){S[t]=function(e){return null==e?"":(""+e).replace(T[t],function(e){return A[t][e]})}}),S.result=function(t,e){if(null==t)return null;var n=t[e];return S.isFunction(n)?n.call(t):n},S.mixin=function(t){L(S.functions(t),function(e){var n=S[e]=t[e];S.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),R.call(this,n.apply(S,t))}})};var B=0;S.uniqueId=function(t){var e=++B+"";return t?t+e:e},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(t,e,n){var r;n=S.defaults({},n,S.templateSettings);var o=new RegExp([(n.escape||z).source,(n.interpolate||z).source,(n.evaluate||z).source].join("|")+"|$","g"),i=0,a="__p+='";t.replace(o,function(e,n,r,o,s){return a+=t.slice(i,s).replace(q,function(t){return"\\"+O[t]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(a+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),o&&(a+="';\n"+o+"\n__p+='"),i=s+e.length,e}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(n.variable||"obj","_",a)}catch(s){throw s.source=a,s}if(e)return r(e,S);var u=function(t){return r.call(this,t,S)};return u.source="function("+(n.variable||"obj")+"){\n"+a+"}",u},S.chain=function(t){return S(t).chain()};var R=function(t){return this._chain?S(t).chain():t};S.mixin(S),L(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];S.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],R.call(this,n)}}),L(["concat","join","slice"],function(t){var e=i[t];S.prototype[t]=function(){return R.call(this,e.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],25:[function(t){"undefined"!=typeof window&&"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)}),Leap=t("../lib/index")},{"../lib/index":11}]},{},[25]);